<div class="printable-title-container">

```dataviewjs
const repoUrl = "https://github.com/Nekojama/Notes";
const fileName = dv.current().file.name;
const mtime = dv.current().file.mtime.toFormat("yy-MM-dd");
const fullHtml = `
<div class="printable-title-container">
  <h1 class="printable-title">${fileName}</h1>
  <div class="custom-divider"></div>
  <a href="${repoUrl}" target="_blank" class="printable-version-info">
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
    <span>检查更新</span>
    <span class="version-date-badge">${mtime}</span>
  </a>
</div>
`;
dv.paragraph(fullHtml);
```
</div>

#初等数论 #解析数论 #组合数学

**完美数**(又称**完全数**),即一个数等于其所有真因子之和的数,对我们来说是不陌生的.例如众所周知的例子 $6=1+2+3$.在本文中,我们将此类经典定义的完美数称为**一般完美数**,并且在不引起歧义时仍简称为**完美数**.

## 1. 一般完美数

>[!note] 定义 1.1 (完美数).
>**完美数**是满足 $\sigma(n)=2n$ 的正整数, 其中$\sigma(n)$是约数和函数.

有关完美数的研究是久远而丰富的,最早可以追溯到公元前六世纪的Pythagoras时代.而Pythagoras,作为一个众所周知的数字神秘主义者,也因此给了完美数以完美的名字.(尽管6在后世和666这个象征"恶魔"的数字脱不了干系,但是那是后话.)
有关完美数更详尽的知识,参见[完全数-数学百科](http://www.shuxueji.com/w/110).

## 2. 积性完美数

### 积性完美数的性质
然而,仍然举6的例子,我们很容易就能发现不仅$6=1+2+3$,还有$6=1\times 2 \times3$.同时,如果再仔细看看其他数,就能发现还有$8=1\times2 \times4$,等等.这也就是在说,不仅存在真因子之和为自身的数,还存在真因子之积为自身的数.对于这样的数,我们暂且称其为**积性完美数**.

>[!note] 定义 2.1 (积性完美数).
>如果一个数的所有真因子之积为自身,那么我们就称其为**积性完美数**.

例如$6=1\times2\times3,8=1\times2\times4,10=1\times2\times5$等等都是积性完美数的例子.

一个很自然的想法,这样的积性完美数有什么性质?如果抛去因子里1这样不影响乘积结果的数,那么可以发现举例的积性完美数都可以写为两个数之积.更进一步地,如果我们用因子的**个数**来统计,这是不是说一个数是积性完美数当且仅当它因子个数为4呢?

>[!faq] 问题 2.2 (积性完美数的因子为4).
一个数是否是积性完美数当且仅当它因子个数为4?

我们做点准备工作,然后试着来证明它.首先,我们定义**因子个数函数**.

>[!note] 定义 2.3 (因子个数函数).
>对于任意自然数$n$,记它的正约数的数目为$d(n)$,我们就称$d(n)$为**因子个数函数**,简称为**因子个数**.

由**算术基本定理**,任何一个大于1的整数$n$都可以被唯一分解为质数的乘积,形式如:
$$
n=p_1^{a_1}\times p_2^{a_2}\times p_3^{a_3}\times \cdots \times p_k^{a_k},
$$
其中$p_i,i=1,2,\cdots,k$为素数,$a_i,i=1,2,\cdots,k$为正整数.
那么基于上式分解,有$n$的任何一个因子$m$都具有以下形式:
$$
m=p_1^{b_1}\times p_2^{b_2}\times p_3^{b_3}\times \cdots \times p_k^{b_k},
$$
其中,每个指数$b_i$满足$0\leq b_i \leq a_i$.更进一步地,对于$p_i$,指数$b_i$有$a_i+1$种选择$(0,1,\cdots,a_i)$.
那么根据乘法原理,$n$的总的因子个数就是这些选择的乘积.即我们有:
$$
d(n)=(a_1+1)\times (a_2+1)\times \cdots \times (a_k+1).
$$
更完整的因子个数函数的详情,参见[除数函数的Wiki页面](https://en.m.wikipedia.org/wiki/Divisor_function).

一个有意思的推论是,一个整数$n$的因子个数$d(n)$是奇数,当且仅当$n$是一个完全平方数.

>[!note] 推论 2.4 
一个整数$n$的因子个数$d(n)$是奇数,当且仅当$n$是一个完全平方数.

**证**:
证明很简单,只需要注意到$d(n)=(a_1+1)\times (a_2+1)\times \cdots \times (a_k+1)$是奇数当且仅当$a_i+1,i=1,2,\cdots,k$都是奇数,也就说明$a_i$都是偶数,也就说明$n$是完全平方数.$\square$

推论2.4等价于:如果$n$不是完全平方数,那么$d(n)$是偶数.那么,此时我们就可以把$n$的因子完美地两两配对为$d(n)/2$组.因为如果$k$是$n$的一个因子,那么$n/k$也必然是$n$的一个因子,并且$k\times(n/k)=n$.受此启发,我们有这样的一个推论:整数$n$的因子之积为$n^{\frac{d(n)}{2}}$.

>[!note] 推论 2.5 
>任何大于1的整数$n$,设其所有正因子组成的集合为$D$,因子个数为$d(n)$,那么$D$中所有元素的乘积$P(n)$等于$n^{\frac{d(n)}{2}}$.

**证**:
设$n$的所有因子为$a_1,a_2,a_3,\cdots,a_{d(n)}$,则有$P(n)=a_1\times a_2\times a_3\times \cdots \times a_{d(n)}$.
而因为若$a_i$是一个因子,那么$n/a_i$也是一个因子,故实际上集合$\{n/a_1,n/a_2,n/a_3,\cdots,n/a_{d(n)}\}$只是对原集合$D$的一个重排.
则我们可以把$P(n)$写为:
$$
P(n)=\frac{n}{a_1}\times \frac{n}{a_2}\times \cdots \frac{n}{a_{d(n)}}
,$$
整理得:
$$
P(n)^2 = n^{d(n)}
,$$
因此:
$$
P(n) = n^{\frac{d(n)}{2}} \quad (\text{取正值根，因所有因子为正}).
$$
$\square$


准备工作做得差不多了,现在我们回到积性完美数上.我们接下来证明一个数是积性完美数当且仅当它因子个数为4.

>[!note] 定理 2.6 (积性完美数的因子个数).
>一个整数$n>1$是积性完美数,当且仅当$d(n)=4$.

**证**:
设$P'(n)$为$n$的所有真因子的乘积,显然一个整数是积性完美数当且仅当$P'(n)=n$.我们的目标是证明对整数$n>1$,有$P(n)=P'(n)\times n \iff d(n)=4$.

**必要性**:
由定义,有$P'(n)=n$,故$P(n)=n^2$,则$P(n)=n^2=n^{\frac{d(n)}{2}}$.
又因为$n>1$,故$2=\frac{d(n)}{2} \Rightarrow d(n)=4$.必要性证毕.

**充分性**:
因为$d(n)=4$,故$P(n)=n^{\frac{d(n)}{2}}=n^2$.又因为$P(n)=P'(n)\times n$,故$P'(n)=n$,充分性证毕.
$\square$

既然我们知道了一个数是积性完美数是有4个因子的数,那么什么样的数有4个因子呢?
回到算术基本定理,我们有:
$$
d(n)=(a_1+1)\times (a_2+1)\times \cdots \times (a_k+1),
$$
要使这个乘积为4,只有两种可能:

1. $n=p^3$,其中$p$是质数.
2. $n=p\times q$,其中$p,q$是两个不同的素数.这种情况下,我们称$n$为**半素数**.

综上,我们完整地解决了积性完美数的分类问题.可见积性完美数与一般完美数相比是非常简单的,这是因为数论中加性的问题通常更复杂,参考整数的拆分.

### 积性完美数的类比与拓展
积性完美数是一类挺有意思的对象.既然我们已经找到了积性完美数的结构,我们就可以用它来做些文章,并且仿照构造它的过程进行类比.

#### 积性完美数的密度
比如,我们知道完美数是非常少的,那么积性完美数呢?这个问题其实就归结到了$p^3$和半素数的密度问题.我们先定义**计数函数**,然后通过研究它们的**渐进密度**来回答它.

>[!note] 定义 2.7 (计数函数).
> 对集合$A\subseteq \mathbb{N}$,其**计数函数**定义为:$A(n) = \text{集合} A \text{中}\leq n \text{的元素个数}$.

>[!note] 定义 2.8 (渐进密度).
> 设 $A \subseteq \mathbb{N}$ 是自然数的子集.$A$的**渐进密度**定义为以下极限(若存在):
> $$
> d(A) = \lim_{n \to \infty} \frac{|A \cap \{1, 2, \dots, n\}|}{n}
> $$
> 其中$|A \cap \{1, 2, \dots, n\}|$ 表示 $A$ 中不超过 $n$ 的元素个数.
> 故渐进密度也等价为:
> $$
> d(A) = \lim_{n \to \infty} \frac{A(n)}{n}
> $$
 
例如,对于偶数集$A=\{{2n|n\in \mathbb{N}}\}$,有$d(A)=0.5$成立.
考虑到完美数的稀有性,我们猜测积性完美数也是非常稀少的.接下来我们就证明积性完美数的渐进密度为0.

>[!note] 定理 2.9 (积性完美数的渐进密度为0).

**证**:
由于积性完美数的结构简单且有限,我们只需分两种情况讨论即可.
***Case 1.*** 定义计数函数 $C(x)$ 为不超过 $x$ 的立方素数的个数:
$$
C(x) = \{ n \le x \mid n = p^3, p \text{ is prime} \}
$$
一个数$n = p^3$不超过 $x$, 当且仅当 $p \le x^{1/3}$.因此, $C(x)$ 就等于不超过 $x^{1/3}$ 的素数的个数. 我们用 $\pi(y)$ 表示不超过 $y$ 的素数个数. 所以, 我们有:
$$
C(x) = \pi(x^{1/3})
$$
根据**素数定理**(当然,这个结论超出了本文范围,见<sup>\[[[#^ref1|1]]]</sup>的Theorem 6),我们知道 $\pi(y) \sim \frac{y}{\ln(y)}$. 将 $y = x^{1/3}$ 代入, 可得:
$$
C(x) \sim \frac{x^{1/3}}{\ln(x^{1/3})} = \frac{3x^{1/3}}{\ln(x)}
$$
故对于立方素数, 其密度为:
$$
\lim_{x \to \infty} \frac{C(x)}{x} = \lim_{x \to \infty} \frac{3x^{1/3}}{x \ln(x)} = \lim_{x \to \infty} \frac{3}{x^{2/3}\ln(x)} = 0
$$
这表明立方素数在自然数中的密度为0, 它们是非常稀有的.

***Case 2.*** 定义计数函数 $\pi_2(x)$ 为不超过 $x$ 的半素数的个数:
$$
\pi_2(x) = \{ n \le x \mid n = pq, p < q \text{ are primes} \} 
$$
对这个函数的研究要复杂得多, 其结果由Landau在20世纪初给出(见<sup>\[[[#^ref2|2]]]</sup>的§56). 其精确的渐近形式是:
$$
\pi_2(x) \sim \frac{x \ln(\ln(x))}{\ln(x)}
$$
同样,这个结论的推导也超出了本文的范围,见<sup>\[[[#^ref1|1]]]</sup>中的Theorem 437.
那么,我们就可以计算半素数的渐近密度:
$$
\lim_{x \to \infty} \frac{\pi_2(x)}{x} = \lim_{x \to \infty} \frac{x \ln(\ln(x))}{x \ln(x)} = \lim_{x \to \infty} \frac{\ln(\ln(x))}{\ln(x)} = 0
$$
这也表明半素数的密度同样为0.
而积性完美数是立方素数和半素数的并集.由于这两类数的密度都为0,因此积性完美数作为一个整体, 在自然数中的渐近密度也为0.
$\square$

尽管两者的密度都为0, 但通过比较它们的计数函数 $C(x)$ 和 $\pi_2(x)$, 我们可以了解它们的增长速度. 当 $x$ 很大时, $\frac{x \ln(\ln(x))}{\ln(x)}$ 的增长速度远快于 $\frac{3x^{1/3}}{\ln(x)}$. 这意味着, 在所有积性完美数中, **绝大多数都是半素数**, 而立方素数则要稀有得多.

#### 积性亲和数
完美数是加性的,加性数论的研究中有很多有意思的概念,比如说**亲和数**(或**友爱数**),它指的是一对数中彼此的全部真因子之和与另一方相等.
>[!note] 定义 2.10 (亲和数).
对于$n,m\in \mathbb{N}$,若$\sigma(m)-m=n,\sigma(n)-n=m$,那么我们就称数对$(n,m)$是一对亲和数,其中$\sigma(n)$是约数和函数.

最有名的亲和数对可能是$(220,284)$,还是Pythagoras,他就曾经说过"朋友是你灵魂的倩影,要像220与284一样亲密."并且,这一对亲和数也在众多和爱情与数学有关的艺术创作中反复出现,比如电影*博士の愛した数式*(博士的爱情方程式).

我们仿照上述亲和数的概念,定义**积性亲和数**.
>[!note] 定义 2.11 (积性亲和数).
>对于$n,m\in \mathbb{N}$,若$P'(n)=m,P'(m)=n$,那么我们就称数对$(n,m)$是一对**积性亲和数**,其中$P'(n)$是$n$的真因子之积.

下面我们来看看积性亲和数有什么性质.我们断言不存在$n \ne m$,使得$P'(n)=m,P'(m)=n$,并马上证明它.
>[!note] 定理 2.12 (不存在非平凡的积性亲和数).
>对于$n,m\in \mathbb{N}$,若$P'(n)=m,P'(m)=n$,则$n=m$.

根据上文的结论,可以得到$P'(n)=n^\frac{d(n)-1}{2}$.则对于积性亲和数我们就有:
$$
\left\{
\begin{align*}
P'(n)&=n^{\frac{d(n)}{2}-1}=m \quad &(1)\\
P'(m)&=m^{\frac{d(m)}{2}-1}=n \quad &(2)
\end{align*}
\right.
$$
将(2)代入(1),得到:
$$
({m^{\frac{d(m)}{2}-1}})^{\frac{d(n)}{2}-1}=m^{({\frac{d(m)}{2}-1})({\frac{d(n)}{2}-1})}=m^1
$$
这意味着:
$$
(\frac{d(m)}{2}-1)(\frac{d(n)}{2}-1)=1
$$
由于$d(n)$是整数,故这个方程唯一的整数解是:
$$
\frac{d(m)}{2}-1=1 \text{ 且 } \frac{d(n)}{2}-1=1
$$
故有$d(m)=d(n)=4$.但是如果$d(n)=4$,那么我们就有
$$
P'(m)=m^{\frac{4}{2}-1}=m \Rightarrow n=m
$$
故**不存在非平凡的积性亲和数**.$\square$
同理,也不存在更长的**积性"社交数"链**.其中"**社交数**"是指一个这样的自然数组$(a,b,c)$,其满足$a$的真因子之和等于$b$,而$b$的真因子之和等于$c$,$c$的真因子之和等于$a$.

#### 既是完美数又是积性完美数的数
我们最后证明一个有意思的小问题来结束这一节.我们已经知道不仅$6=1+2+3$,还有$6=1\times 2 \times3$.那么,$6$是唯一的这样的数吗?
>[!faq] 问题 2.13 (既是完美数又是积性完美数的数)
>存不存在除了6以外其他的既是完美数又是积性完美数的数?

我们断言这样的数只有6,并且接下来证明它.
**证**: 
我们分$n=p^3$和$n=pq$的情况讨论,其中$p,q$是不同的素数.
***Case 1***. 若$n=p^3$,则$\sigma(n)=1+p+p^2+p^3=2p^3$.整理得$p^3-p^2-p-1=0$,而对于素数$p$,$p^3-p^2-p=p(p^2-p-1)$显然不等于1.
***Case 2***. 若$n=pq$,则$\sigma(n)=1+p+q+pq=2pq$,整理得$(p-1)(q-1)=2$.对于素数$p,q$,该方程的解仅为$p-1=1,q-1=2$(或反过来).故$p=2,q=3$.
综上所述,6是唯一一个既是完美数又是积性完美数的数.$\square$

看来,6这个数字的确是非常美丽.难怪Pythagoras会说"6象征着完满的婚姻以及健康和美丽"呢!

## 3. 一个可能的推广: 积性$k$-完美数
虽然积性完美数自身很简单,不过我们还可以模仿“$k$-完美数”($\sigma(n) = kn$)来定义一个新概念.

>[!note] 定义 3.1 (积性$k$-完美数).
>如果一个整数 $n>1$ 的所有真因子之积$P'(n)=n^k$, 我们就称之为**积性$k$-完美数**.

仿照定理2.6的方式,我们可以得到一个非常优美的条件:
$$
d(n) = 2(k+1) \iff P'(n)=n^k.
$$
这个推广将一个简单概念变得更有系统性.下面是$k$比较小时的积性$k$-完美数的例子.

|k值|d(n)|因子结构|例子|
|---|---|---|---|
|$k=1$|4|$p^3$, $p\times q$|6, 8...|
|$k=2$|6|$p^5$, $p^2\times q$|12, 32...|
|$k=3$|8|$p^7$, $p^3 \times q$,$p\times q \times r$|24, 30, 128...|
|$k=4$|10|$p^9$, $p^4 \times q$|48...|
|$k=5$|12|$p^{11}$, $p^5\times q$, $p^3\times q^2$, $p^2\times q\times r$|96...|
|...|...|...|...|

定义积性$k$-完美数后最大的问题就落在其因子结构上.而这其实就等价于寻找整数$N=2(k+1)$的**无序乘法分拆**.具体来说,积性$k$-完美数$n$的所有可能结构,与$N=2(k+1)$的所有乘法分拆一一对应.

>[!note] 定义 3.2 (整数的乘法分拆).
对于一个大于 1 的整数 $N$, 我们将 $N$ 表示为一组大于 1 的整数的乘积 (不考虑顺序),
$$ N = f_1 \cdot f_2 \cdot \dots \cdot f_m, \quad f_i > 1 $$
 称这样的一组数 $\{f_1, f_2, \dots, f_m\}$ 为 $N$ 的一个乘法分拆.

一个整数 $N$ 的不同乘法分拆的个数, 通常用函数 $f(N)$ 表示.

### 结构与分拆的对应关系

如果一个数 $n$ 的素数分解为 $n = p_1^{a_1} p_2^{a_2} \dots p_m^{a_m}$, 那么它的因子个数为:
$$ d(n) = (a_1+1)(a_2+1)\dots(a_m+1) $$
令 $d(n) = N = 2(k+1)$, 并设 $f_i = a_i+1$, 我们就得到了 $N$ 的一个乘法分拆$N= f_1 \cdot f_2 \cdot \dots \cdot f_m$.

因此,**寻找所有积性$k$-完美数的素数结构,等价于寻找 $N=2(k+1)$ 的所有乘法分拆.**

>[!example] 示例 3.3 ($k=5$ 时$2(k+1)$的乘法分拆与积性$k$-完美数的因子结构).

当 $k=5$ 时, 我们需要研究 $N = 2(5+1) = 12$ 的所有乘法分拆.

1.  **分拆为 1 个因子 ($m=1$):**
    *   $12$.
    *   对应 $f_1 = 12$, 推出 $a_1 = f_1-1 = 11$.
    *   结构: $p^{11}$ (如 $2^{11}$).

2.  **分拆为 2 个因子 ($m=2$):**
    *   $6 \times 2$.
    *   对应 $\{f_1, f_2\} = \{6, 2\}$, 推出 $\{a_1, a_2\} = \{5, 1\}$.
    *   结构: $p^5 q$ (如 $2^5 \cdot 3$).
    *   $4 \times 3$.
    *   对应 $\{f_1, f_2\} = \{4, 3\}$, 推出 $\{a_1, a_2\} = \{3, 2\}$.
    *   结构: $p^3 q^2$ (如 $2^3 \cdot 3^2$).

3.  **分拆为 3 个因子 ($m=3$):**
    *   $3 \times 2 \times 2$.
    *   对应 $\{f_1, f_2, f_3\} = \{3, 2, 2\}$, 推出 $\{a_1, a_2, a_3\} = \{2, 1, 1\}$.
    *   结构: $p^2 qr$ (如 $2^2 \cdot 3 \cdot 5$).

因为 $2 \times 2 \times 2 \times 2 = 16 > 12$, 所以不可能分拆为 4 个或更多因子.

综上, 对于 $k=5$, 积性5-完美数共有 4 种不同的素数结构: $p^{11}$, $p^5 q$, $p^3 q^2$ 和 $p^2 qr$.
$\clubsuit$

言而总之,对于任意给定的 $k$, 我们都可以通过以下步骤确定所有 k-积性完美数的结构:
1.  计算目标因子数 $N = 2(k+1)$.
2.  找出整数 $N$ 的所有无序乘法分拆 $\{f_1, f_2, \dots, f_m\}$. 这一步是问题的组合核心.
3.  每一个乘法分拆 $\{f_1, \dots, f_m\}$ 都对应一类 k-积性完美数的结构, 其素数指数集为 $\{f_1-1, \dots, f_m-1\}$.

综上,我们便从一个简单的概念牵引出了更多的有意思的概念.不过正如Descartes曾预言的那样:"能找出完全数是不会多的,好比人类一样,要找一个完美人亦非易事."这篇文章也不能被称为完美.在不久的将来或许还有可以补充的地方.


---
## 参考文献
1. Hardy, G. H., & Wright, E. M. (2008). *An Introduction to the Theory of Numbers* (6th ed.). Oxford University Press. (Original work published 1938) ^ref1
2. Landau, E. (1909). *Handbuch der Lehre von der Verteilung der Primzahlen*. B. G. Teubner. ^ref2