---
publish: true
icon: LiCheck
---

<div class="printable-title-container">

```dataviewjs
const repoUrl = "https://github.com/Nekojama/Notes";
const fileName = dv.current().file.name;
const mtime = dv.current().file.mtime.toFormat("yy-MM-dd");
const fullHtml = `
<div class="printable-title-container">
  <h1 class="printable-title">${fileName}</h1>
  <div class="custom-divider"></div>
  <a href="${repoUrl}" target="_blank" class="printable-version-info">
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
    <span>检查更新</span>
    <span class="version-date-badge">${mtime}</span>
  </a>
</div>
`;
dv.paragraph(fullHtml);
```
</div>

## 1. 引子

>[!faq] 问题 1.1 
>设$f(x) \in C^1[0,1]$, $f(0)=f(1)=1$, $\max \limits_{0\le x\le 1}\{|f'(x)|\}\le1$.
>1. 证明$\frac{3}{4} <\int_0^1 f(x)dx <\frac{5}{4}$;
>2. 令$S = \left\{ \int_0^1 f(x)dx \mid f \in C^1, f(0)=f(1)=1, \max|f'|\le1 \right\}$, 证明$\inf S = \frac{3}{4}$, $\sup S = \frac{5}{4}$, 但$\max S, \min S$不存在.

注意到设$g(x) = f(x)-1$, 则条件转化为: $g(0)=g(1)=0$ 和 $|g'(x)| \le 1$. 下面不做两个条件具体的区分.

### 问题1.1 (1)的证明

在我们证明问题1.1 (1)之前, 先看一个"错误"的解法.

>[!error]  直接使用分部积分法 (一个过松的估计).
>**解**:
>$$
>\begin{align*}
>I=\int_{0}^{1} g(x) dx 
>&=[g(x)]x|_{0}^{1} -\int_{0}^1x dg(x) \\
>&=-\int_{0}^{1} xg'(x) dx
>\end{align*}
>$$
故$|I| = \left|-\int_0^1 x g'(x) dx\right| \le \int_0^1 |x||g'(x)| dx \le \int_0^1 x \cdot 1 dx = \frac{1}{2}$. 故$\frac{1}{2} <\int_0^1 f(x)dx <\frac{3}{2}$. $\clubsuit$

这个范围是正确的, 但是不够紧. 为什么?

这是因为当我们使用不等式$-x ≤ xg'(x) ≤ x$ 并对其积分时, 我们实际上是假设 $g'(x)$可以"自由地"在$[-1, 1]$之间取值, 以使得$\int_0^1 xg'(x) dx$达到最大值  $\frac{1}{2}$或最小值 $-\frac{1}{2}$. **但$g'(x)$并不是完全自由的!** 它受到了一个非常强的全局约束: $g(0) = 0$且 $g(1) = 0$. 根据Rolle定理, 这保证了在$(0, 1)$区间内至少存在一个点$c$, 使得$g'(c) = 0$. 这就意味着**$g'(x)$不可能在整个$[0, 1]$区间上一直等于$1$或者一直等于$-1$**. 若不然,  如果$g'(x)$总是$1$, 那么$g(x) = x$, 则$g(1)$会等于$1$, 同理, 若如果$g'(x)$总是$-1$, 也会与已知条件矛盾.
故, $g'(x)$必须在$-1$与$1$之间变化, 还要穿过$0$. 形象化地说, $g(x)$这条曲线不仅不能太陡峭, 而且应该位于一个"通道"内. 为什么呢? 因为满足$g(0)=g(1)=0$最简单的函数就是$g(x)=0$这条直线, 而现在我们有了$|g'(x)| \le 1$这个条件, $g$就可以略微偏离$y=0$这条直线, 但是不能偏移太多. 

受几何直观的启发, 我们有下面的证明. 

#### 法一: 利用Lagrange中值定理构造边界函数

我们想利用已知条件来确定函数 $f(x)$ 图形必须位于的一个"通道". 这个通道由一个上界函数和一个下界函数构成, 然后通过对这两个边界函数积分来得到原积分的范围.
于是, 什么样的工具能让我们**找到函数在某点上的值($f(0)$, $f(1)$), 函数的导数($f'(x)$)与函数本身($f(x)$)的的关系**? Lagrange中值定理! 下面是具体过程.

**证**:
1. **构造 $f(x)$ 的下界**
	1. 在区间$[0, x]$上应用拉格朗日中值定理, 存在 $c_1 \in (0, x)$ 使得:
$$f(x) - f(0) = f'(c_1)(x - 0).$$
因为$f(0)=1$且$f'(c_1) \ge -1$, 我们得到: $f(x) - 1 \ge -x \implies f(x) \ge 1 - x$;
	2. 在区间$[x, 1]$上应用拉格朗日中值定理, 存在 $c_2 \in (x, 1)$ 使得:
$$f(1) - f(x) = f'(c_2)(1 - x).$$
因为$f(1)=1$且$f'(c_2) \le 1$, 我们得到: $1 - f(x) \le 1 - x \implies f(x) \ge x$.
而$f(x)$ 必须同时满足这两个条件, 因此有:$f(x) \ge \max\{x, 1-x\}$.

2. **构造 $f(x)$ 的上界**
	1. 同理, 由 $f(x) - 1 = f'(c_1)x$ 和 $f'(c_1) \le 1$ 可得: $f(x) \le 1 + x$;
	2. 由 $1 - f(x) = f'(c_2)(1 - x)$ 和 $f'(c_2) \ge -1$ 可得: $1 - f(x) \ge -(1-x) \implies f(x) \le 2 - x$.
而$f(x)$ 的上界是两者中的较小值: $f(x) \le \min\{1+x, 2-x\}$.

3. **对边界进行积分**
*   **下界积分**:
    $\int_0^1 f(x) dx \ge \int_0^1 \max\{x, 1-x\} dx = \int_0^{1/2} (1-x) dx + \int_{1/2}^1 x dx = \frac{3}{8} + \frac{3}{8} = \frac{3}{4}$
*   **上界积分**:
    $\int_0^1 f(x) dx \le \int_0^1 \min\{1+x, 2-x\} dx = \int_0^{1/2} (1+x) dx + \int_{1/2}^1 (2-x) dx = \frac{5}{8} + \frac{5}{8} = \frac{5}{4}$

因为 $f(x)$ 是可导函数, 而边界函数在 $x=1/2$ 处不可导, 所以等号取不到.

综上所述,有 $\frac{3}{4} < \int_0^1 f(x) dx < \frac{5}{4}$. $\square$

#### 法二: 利用Newton-Leibniz公式

可是, 如果我没有这种几何直观, 或者说我想找到一个更通用的方法, 那还有什么办法呢? 下面的方法从最根本的定义出发. **用$f'(x)$ 表示 $f(x)$, 然后通过求解一个带约束条件的变分问题来找到精确的极值**. 下面是具体过程.

1. **用导数表示函数**
根据N-L公式, 有:
$$f(x) = f(0) + \int_0^x f'(t) dt = 1 + \int_0^x f'(t) dt.$$

2. **代入目标积分并交换积分次序**
将上面得到的$f(x)$代入原式, 可得:
$$\int_0^1 f(x) dx = \int_0^1 \left(1 + \int_0^x f'(t) dt\right) dx = 1 + \int_0^1 \left(\int_0^x f'(t) dt\right) dx.$$
由于$f$连续, 故可交换双重积分的次序:
$$\int_0^1 \int_0^x f'(t) dt dx = \int_0^1 \int_t^1 f'(t) dx dt = \int_0^1 f'(t) (1-t) dt.$$
所以: $\int_0^1 f(x) dx = 1 + \int_0^1 (1-t)f'(t) dt$.

3. **求解带约束的极值问题**
我们需要在以下两个约束条件下, 求 $\int_0^1 (1-t)f'(t) dt$ 的极值:
$$
\left\{
\begin{array}{ll}
  \text{约束1: } |f'(t)| \le 1; \\
  \text{约束2: } \int_{0}^{1} f'(t)dt = f(1) - f(0) = 0.
\end{array}
\right.
$$
现在被积函数是 $(1-t)f'(t)$, 因子$(1-t)$ 是一个正的, 递减的权重.
**求最小值**: 为了使积分最小, 当权重 $(1-t)$ 大时(即 $t$ 较小时), 应使 $f'(t)$ 取其最小值$-1$; 当权重小时(即 $t$ 较大时), 应使$f'(t)$取其最大值$1$. 为了满足约束2, 切换点必须在 $t=\frac{1}{2}$. 有:
$$\min \int_0^1 (1-t)f'(t) dt = \int_0^{1/2} (1-t)(-1)dt + \int_{1/2}^1 (1-t)(1)dt = -\frac{3}{8} + \frac{1}{8} = -\frac{1}{4}.$$
**求最大值**: 同理, 当 $t$ 较小时取 $f'(t)=1$, 当 $t$ 较大时取 $f'(t)=-1$. 有:
$$\max \int_0^1 (1-t)f'(t) dt = \int_0^{1/2} (1-t)(1)dt + \int_{1/2}^1 (1-t)(-1)dt = \frac{3}{8} - \frac{1}{8} = \frac{1}{4}.$$
最后, 将极值代回第二步的表达式, 得到最小值: $1 + (-\frac{1}{4}) = \frac{3}{4}$, 最大值: $1 + (\frac{1}{4}) = \frac{5}{4}$.

综上所述,有 $\frac{3}{4} < \int_0^1 f(x) dx < \frac{5}{4}$. $\square$

实际上, 这里的第2步等价于处理$I = \int_0^1 g(x)dx$时, 采用$v=x-1$而$dx=dv$的分部积分: 
$$
\begin{align*}
I &= \int_0^1 g(x)dx = \left[ g(x) \cdot (x-1) \right]_0^1 - \int_0^1 (x-1) g'(x) dx \\
&=\int_0^1 (1-x) g'(x) dx.
\end{align*}
$$
这可以被看做是权重函数针对$x=\frac{1}{2}$点做了一个反射. 其实现在我们应该可以发现这个积分和点$x=\frac{1}{2}$关系很密切, 并且存在某种对称性, 比如$f'(x)$在$x=\frac{1}{2}$处应该得变号以得到最值. 下面, 我们展示这种对称性的来源以及它如何帮我们解决这道问题.

#### 法三: 代数均值法 

这个方法在于, 我们**利用$I$的两个表达式得到$I$的另一种表达, 在新得到的表达下利用其对称性来进行估算**. 下面是具体过程.

1.  **建立两个表达式**:
由最开始的直接分部积分的方法可知:
$$I = -\int_0^1 x g'(x) dx;$$
由方法二可知:
$$I = \int_0^1 (1-x) g'(x) dx.$$
2.  **取平均值**:
$$
\begin{align*}
I = \frac{1}{2} (I+I) &= \frac{1}{2} \left[ -\int_0^1 x g'(x) dx + \int_0^1 (1-x) g'(x) dx \right] \\
&= \frac{1}{2} \int_0^1 (1-2x)g'(x) dx \\
&= \int_0^1 (\frac{1}{2}-x)g'(x) dx.
\end{align*}
$$
注意, 这里的权重函数 $w(x) = \frac{1}{2}-x$ 是关于中点 $x=1/2$ **奇对称**的!
3.  **估计**:
我们有:
$$
|I| = \left|\int_0^1 (\frac{1}{2}-x)g'(x) dx\right| \le \int_0^1 \left|\frac{1}{2}-x\right||g'(x)|dx \le \int_0^1 \left|\frac{1}{2}-x\right|dx
$$
而$\int_0^1 \left|\frac{1}{2}-x\right|dx = \int_0^{1/2}(\frac{1}{2}-x)dx + \int_{1/2}^1(x-\frac{1}{2})dx = \frac{1}{8} + \frac{1}{8} = \frac{1}{4}$, 故$\frac{3}{4} < \int_0^1 f(x) dx < \frac{5}{4}$.

综上所述,有 $\frac{3}{4} < \int_0^1 f(x) dx < \frac{5}{4}$. $\square$

### 问题1.1 (2)的证明

解决了问题1.1 (1)后, 剩下的虽然看起来很唬人, 但是并不困难. 确界和最值非常微妙但至关重要的区别恰好来自于问题中的条件 $f(x) \in C^1$. 我们只要解决其是确界就能解决最值的问题, 并且, 如果我们能解决上下确界中的一个, 那么剩下的一个如法炮制即可. 下面我们聚焦于下确界.

回顾下确界的定义: 一个集合的下确界是**小于或等于**该集合中所有元素的最大值. 一个关键性质是. 我们可以找到集合中的一个元素序列. 使其**无限逼近**下确界. 

于是, 我们可以试着构造一个函数序列 $f_n(x)$, 使得它们满足$f_n(x) \in C^1$ 的所有条件, 并且它们的积分可以**任意地逼近** $\frac{3}{4}$. 

**构造方法：平滑尖角 (Smoothing the Corner)**

首先, 以我们理想中的但不被允许的V字形函数 $f_{inf}(x)$ 为目标, 其中
$$
f_{inf}(x) = \begin{cases} 1-x, & x \in [0, 1/2] \\ x, & x \in [1/2, 1] \end{cases}
$$
这个函数 $f_{inf}(x)$ 满足 $f(0)=f(1)=1$ 和 $|f'(x)|=1$(在可导的地方), 并且它的积分**恰好**是 $\frac{3}{4}$. 现在我们在尖角 $x=1/2$ 附近取一个很小的邻域, 例如 $[1/2 - \epsilon_n, 1/2 + \epsilon_n]$，其中 $\epsilon_n \to 0$. 在这个小邻域内, 我们不再使用两条直线硬拼, 而是用一段光滑的曲线(例如一段满足 $|f'(x)|\le 1$ 的三次多项式或圆弧)来连接它们. 这段曲线的切线将从-1平滑地过渡到+1.  在邻域之外, 函数 $f_n(x)$ 与 $f_{inf}(x)$ 完全相同.

可以验证, 通过这种方法构造出的函数 $f_n(x)$: 
*   处处可导, 并且导数是连续的, 所以 $f_n(x) \in C^1$;
*   仍然满足 $f_n(0)=f_n(1)=1$ 和 $|f_n'(x)| \le 1$;
故它是完全合法的候选函数.

当我们让 $n \to \infty$(即 $\epsilon_n \to 0$)时, 这个“平滑区域”会无限缩小, 函数序列 $f_n(x)$ 会逐点收敛于V字形函数 $f_{inf}(x)$. 因此，它们的积分也会收敛于 $f_{inf}(x)$ 的积分:
$$\lim_{n \to \infty} \int_0^1 f_n(x)dx = \int_0^1 f_{inf}(x)dx = \frac{3}{4}. $$

这意味着, 对于任何你给定的一个比 $\frac{3}{4}$ 大的数(例如 $\frac{3}{4} + 0.00001$),我总能通过选取一个足够大的$n$来构造一个完全合法的函数$f_n(x)$, 使得它的积分值落在 $(\frac{3}{4}, \frac{3}{4} + 0.00001)$ 之间. 这正是下确界的定义! 同理, $\frac{5}{4}$ 是积分值的上确界.

但是, **由于达到这些确界的函数不属于 $C^1$ 空间**, 所以$\min S$ 不存在, 因为它不可达, 同理$\max S$也不存在. $\square$

## 2. 我们能从这个问题得到什么?

如果要评判问题1.1 (1)的解法出个一二三来, 那么解法三可能是最优雅的. 但是这个方法到底为什么能行呢?

我们稍微做一些翻译. 首先我们把目光聚焦于问题的背景, 但碍于笔者自身水平和篇幅, 这里只简单地Sketch一下: 

- 已知所有在$[0,1]$上Riemann可积的函数构成空间$R[0,1]$. 我们为其配备内积$\langle f, g \rangle = \int_0^1 f(x)g(x)dx$, 那么它构成一个**赋范向量空间**, 其上的$L^2$范数由内积诱导:$||f|| = \sqrt{\langle f, f \rangle} = (\int_0^1 f(x)^2 dx)^{1/2}$. 具体来说, 它是一个**pre-Hilbert空间**, 因为它不完备. 

- 定义内积是为了定义正交(或垂直). 如果两个函数的内积为0,即$\langle f,g\rangle=0$, 那么我们就称这两个函数**正交**.

现在, 让我们用新的语言来看原问题. 因为$g(0)=g(1)=0$, 故$\int_0^1 g'(x)dx = 0$. 且我们有:
$$
\int_0^1 g'(x)dx = 0 \iff \int_0^1 g'(x) \cdot 1 dx = 0 \iff \langle g', 1 \rangle = 0.
$$
其几何意义是, 我们想求的所有合法的函数 $g'(x)$ 都必须**与常函数$1$正交**. 于是约束条件要求我们的$g'(x)$只能落在这个与$1$"垂直"的巨大的子空间里. 现在, 因为我们的积分目标具有$\int_0^1 w(x)g'(x)dx$的形式, 那么这个问题也就是在问: **在所有我们能找到的$g'(x)$里, 这个内积最大能达到多少**? 考虑到内积的性质, 我们实际上只需要$w(x)$垂直于$1$的那部分就行了!

现在我们来试着对$w(x)$这个向量做分解. 为了做分解, 我们要使用**Hilbert空间中的正交分解定理**. 下面是分解的具体过程.

1. **空间的嵌入**
由于我们的空间$R[0,1]$是pre-Hilbert空间, 它不是完备的, 我们需要把它嵌入到完备的Hilbert空间内. 这个过程叫做空间的完备化. 其过程的Sketch是: 
	1. 考虑$R[0,1]$中的所有**Cauchy列**的集合, 记为S.
	2. 定义**等价关系**和**等价类**: 两个Cauchy列$f_n(x)$, $g_n(x)$等价(记作$f_n(x) \backsim g_n(x)$), 当且仅当$\lim||f_n(x)-g_n(x)||=0$, 即它们收敛到同样的点. 所有收敛到同一个元素的Cauchy列记为$[f_n(x)]$, 即选取其中的$f_n(x)$作为代表的等价类.
	3. 将我们每一个等价类视作新空间的一个元素, 这个等价类就是新空间中的一个点.
	4. 在新的空间内定义加法, 数乘和内积: 
	$$
	\left.
	\begin{array}{ll}
	\text{(加法)} \quad[f_n(x)]+[g_n(x)]=[f_n(x)+g_n(x)]; \\
	\text{(数乘)} \quad c \cdot [f_n(x)]= [c \cdot f_n(x)], \quad c \in \mathbb{R}; \\
	\text{(内积)} \quad \langle [{f_n}], [{g_n}]\rangle = \lim \langle f_n, g_n\rangle.
	\end{array}
	\right.
	$$
	并且可证明内积的极限存在且与代表元的选择无关.
	5. 大功告成, 这个空间就是所有在$[0,1]$上Riemann可积的函数的空间$R[0,1]$的完备化, 具体来说, 它就是$L^2[0,1]$, 其中$L^2[0,1]$是空间是所有在$[0, 1]$上**Lebesgue可测**且**平方可积**的函数构成的空间.
这样, 我们就能把$R[0,1]$中的操作搬到一个完备的Hilbert空间中处理了, 因为$R[0,1]$现在是$L^2[0,1]$的一个子空间.
2.**利用Hilbert空间中的正交分解定理分解$w(x)$** 
正交分解定理表述为: 设$H$为Hilbert空间, $M$为$H$的闭子空间, 则对任意$x\in H$, 存在唯一$y\in M$, 以及$z\in M^\bot$使得$x=y+z$且$||x||=||y||+||z||$. 在这个问题中, 因为平行于$1$的子空间(常函数空间)是闭的, 故我们可以对$w(x)$进行正交分解, 得到
$$
w(x) = w_{\parallel}(x) + w_{\perp}(x),
$$
其中$w_{\parallel}(x)$是$w(x)$ 中平行于常数函数$1$的部分, $w_{\perp}(x)$是$w(x)$ 中正交于常数函数$1$的部分. 具体来说, 这个分解是这样的: 
对平行于常数$1$的部分, 因为平行于常数函数$1$的函数其本身必然也是一个常数, 且这个常数值就是 $w(x)$ 在$1$方向上的"投影", 故有
$$
w_{\parallel}(x) = \frac{\langle w, 1 \rangle}{\langle 1, 1 \rangle} \cdot 1 = \frac{\int_0^1 w(x)dx}{\int_0^1 1^2 dx} = \int_0^1 w(x)dx = \bar{w}.
$$
不难发现其大小等于$w(x)$的在$[0,1]$上**平均值**. 而其余的正交的部分只用作差就可以,
$$w_{\perp}(x) = w(x) - w_{\parallel}(x) = w(x) - \bar{w}.$$
可以验证它的确与$1$正交:
$$\langle w_{\perp}, 1 \rangle = \int_0^1 (w(x)-\bar{w})dx = \int_0^1 w(x)dx - \int_0^1 \bar{w}dx = \bar{w} - \bar{w} \cdot 1 = 0.$$

现在让我们回到原问题, 把得到的分解带入目标积分:
$$
I = \langle w, g' \rangle = \langle w_{\parallel} + w_{\perp}, g' \rangle,
$$
并利用内积的线性性, 得到:
$$
I = \langle w_{\parallel}, g' \rangle + \langle w_{\perp}, g' \rangle.
$$
现在, 对于第一项$\langle w_{\parallel}, g' \rangle$, 有$\langle w_{\parallel}, g' \rangle=\langle \bar{w}, g' \rangle = \int_0^1 \bar{w} g'(x)dx = \bar{w} \int_0^1 g'(x)dx$. 而根据我们的约束条件, $\int_0^1 g'(x)dx = 0$. 所以, 这一项永远等于零! 即我们有$\langle w_{\parallel}, g' \rangle = 0$. 同时第二项保留了下来, 它就是我们需要的部分.
于是我们得到了一个恒等式:
$$I = \int_0^1 w(x)g'(x)dx = \int_0^1 w_{\perp}(x)g'(x)dx = \int_0^1 (w(x) - \bar{w})g'(x)dx.$$
在本题中, 有$w(x)=-x$, $\bar{w} = \int_0^1 (-x)dx = -1/2$, $w_{\perp}(x) = -x - (-1/2) = \frac{1}{2}-x$. 这就是为什么方法3中出现了$\frac{1}{2}-x$! 
实际上, 根据我们刚刚得到的正交分解的结论, 有
1. 对$w_1(x) = -x$, 其平均值为: $\bar{w}_1 = \int_0^1 (-x)dx = -1/2$, 正交分量为: $w_{1, \perp}(x) = w_1(x) - \bar{w}_1 = (-x) - (-\frac{1}{2}) = \frac{1}{2}-x$.
2. 对$w_2(x) = 1-x$, 其平均值为: $\bar{w}_2 = \int_0^1 (1-x)dx = 1/2$, 正交分量为: $w_{2, \perp}(x) = w_2(x) - \bar{w}_2 = (1-x) - \frac{1}{2} = \frac{1}{2}-x$. 

并且有我们有$I = \langle w_{1}, g' \rangle = \langle w_{2}, g' \rangle$, 故当我们计算平均值时, 实际上是计算了
$$I = \frac{I+I}{2} = \frac{1}{2}(\langle w_1, g' \rangle + \langle w_2, g' \rangle) = \langle \frac{w_1+w_2}{2}, g' \rangle,$$
即
$$I = \langle \frac{(w_{1,\parallel}+w_{1,\perp}) + (w_{2,\parallel}+w_{2,\perp})}{2}, g' \rangle.$$
由于$\langle w_{\parallel}, g' \rangle=0$, 这个表达式等价于:
$$I = \langle \frac{w_{1,\perp} + w_{2,\perp}}{2}, g' \rangle = \langle \frac{(\frac{1}{2}-x) + (\frac{1}{2}-x)}{2}, g' \rangle = \langle \frac{1}{2}-x, g' \rangle.$$
也就是说, 我们通过巧妙的一次代数运算, 正好把$w_1(x)$和$w_2(x)$的**平行分量**(平均值)抵消了! 于是得到了这个结果.











```dataviewjs
dv.view("Scripts/DataviewScripts/randomSignature")
```


